# node-red-contrib-tfr2cot
Requests TFR List for a given state from https://tfr.faa.gov/ and creates cursor-on-target (CoT) polygon messages sent to a Team Awareness Kit (TAK) Server or network

**ATAK Screenshots**
<img src="docs/atak_tfr_Screenshot_01.png" width="600"/>
<img src="docs/atak_tfr_Screenshot_02.png" width="600"/>

**FAA Website from url in `Associated Link` field in the TFR / CoT information menu:**
<img src="docs/faa_tfr_link_from_ATAK.png" width="600"/>

## SUMMARY

This Node RED subflow pulls a list of current Federal Aviation Administration (FAA) [Temporary Flight Restrictions (TFRs)](https://tfr.faa.gov/), and if any exist for the desired / supplied state, it downloads the xml file for each TFR and creates a [Team Awareness Kit](https://tak.gov) cursor-on-target (CoT) polygon message and sends it to a TAK Server or TAK network using [node-red-contrib-tak](https://github.com/snstac/node-red-contrib-tak) and `tcp out` nodes:

<img src="docs/tfr2tak_node_diagram.png" width = "600"/>

### Pre-Requisite
1. Node RED installed and continuously running (See Greg Albrecht's [video](https://youtu.be/1mHphHhX4lk) on how to install Node-Red on Windows.
2. TAK Network, TAK Server, or WinTAK EUD if running Node-RED on windows.
   
### If using a TAK Server (Optional)
1. An open port on your TAK Server using an `x509` authorization if you plan to use tls (most secure)
2. A certificates generated by the TAK Server and the TCP node ([See Greg Albrect's video](https://youtu.be/5i-y3Nc01Hs)) or [here]([https://node-red-contrib-tak.readthedocs.io/en/latest/](https://node-red-contrib-tak.readthedocs.io/en/latest/tls/))

## LIMITATIONS
TFRs with multiple areas may only pick one area.  Future updates will correct this.

## REQUIRED NODES
1. **INJECT:**  The `msg.payload` should be set to a US state abbreviation (e.g. AZ, CA, NY, etc).
2. [**node-red-contrib-tak:**](https://node-red-contrib-tak.readthedocs.io/en/latest/tls/)  This node is required to pass the CoT message from this subflow to a TAK Server or EUDs on a network. 
3. **TCP OUT:** 
   - **TAK Server:** If using TLS, check on the SSL / TLS option and create or edit your TLS Configuration, as needed.
   - **UDP:** This would need to be configured to your vpn settings and requires your Node Red instance to be on the same vpn to multicast to TAK end-user-devices.

For more information on how to set up the network and [node-red-contrib-tak](https://node-red-contrib-tak.readthedocs.io/en/latest/) nodes, see https://node-red-contrib-tak.readthedocs.io/en/latest/

## INSTALLATION:
1. Import -> Paste the `./examples/node-red-contrib-tfr2cot_subflow.json` file into to Node-RED into the import dialog.
2. Install using `npm`:  `npm i node-red-contrib-tfr2cot`

## License & Copyright

Copyright 2023 CLP Development, LLC

Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at:

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License.
